<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Introduction to ATAC-seq Analysis Pipeline</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <div class="scroll-progress-wrap"><div class="scroll-progress-bar"></div></div>

  <header class="site-header">
    <a href="../index.html" class="site-title">Bioinformatics</a>
    <nav class="site-nav">
      <a href="../index.html">Home</a>
    </nav>
  </header>

  <article class="blog-article">
    <header class="article-header">
      <h1 class="article-title">Introduction to ATAC-seq Analysis Pipeline</h1>
      <p class="article-subtitle"> In this chapter, we'll break down how ATAC-seq works, why it's run the way it is, and how raw sequencing data gets transformed into meaningful biological insights. By the end, you should be able to answer questions like: what is the biology driving this assay, why does paired-end sequencing matter here, and what does a typical analysis pipeline actually look like from start to finish, no deep computational background required.</p>
      <figure class="article-figure">
        <img src="../images/atac_seq.png" alt="ATAC-seq analysis pipeline overview">
      </figure>
      <div class="article-meta">
        <div class="meta-column">
          <span class="meta-label">Author</span>
          <span class="meta-value">Yerkem Shakhman</span>
        </div>
        <div class="meta-column">
          <span class="meta-label">Chapter</span>
          <span class="meta-value">1 — Introduction</span>
        </div>
      </div>
    </header>

    <div class="article-body">
      <aside class="article-toc">
        <h2 class="toc-title">Contents</h2>
        <nav class="toc-nav">
          <ul class="toc-list">
            <li><a href="#what-is">What is ATAC-seq?</a></li>
            <li>
              <a href="#paired-end">Single-end vs Paired-end</a>
            </li>
            <li>
              <a href="#pipeline-overview">Pipeline Overview</a>
              <ul>
                <li><a href="#stage-a">Stage A — Data Processing</a></li>
                <li><a href="#stage-b">Stage B — Peak Calling</a></li>
                <li><a href="#stage-c">Stage C — Downstream Analysis</a></li>
              </ul>
            </li>
            <li>
              <a href="#detailed-steps">Step-by-Step Walkthrough</a>
              <ul>
                <li><a href="#step-1">Pre-alignment QC</a></li>
                <li><a href="#step-2">Adapter Trimming</a></li>
                <li><a href="#step-3">Alignment</a></li>
                <li><a href="#step-4">Filtering</a></li>
                <li><a href="#step-5">Tn5 Offset</a></li>
                <li><a href="#step-6">Peak Calling</a></li>
                <li><a href="#step-7">Merge Peaks</a></li>
                <li><a href="#step-8">Downstream Analyses</a></li>
              </ul>
            </li>
            <li><a href="#qc-metrics">Key QC Metrics</a></li>
            <li><a href="#common-problems">Common Problems</a></li>
            <li><a href="#recommended-tools">Tools & Pipelines</a></li>
            <li><a href="#workflow-checklist">Practical Checklist</a></li>
            <li><a href="#glossary">Glossary</a></li>
            <li><a href="#references">References</a></li>
          </ul>
        </nav>
      </aside>

      <div class="article-content">
        <section id="what-is">
          <h2>What is ATAC-seq?</h2>
          <p>
            ATAC-seq, which stands for <em>Assay for Transposase-Accessible Chromatin using sequencing</em>, is a technique that maps open, accessible regions of the genome by exploiting the behavior of a hyperactive enzyme called Tn5 transposase. Tn5 is loaded with sequencing adapters and preferentially inserts them into regions of chromatin that are not tightly packed by nucleosomes or other proteins, in other words, regions that are open and actively involved in gene regulation, such as promoters and enhancers. After insertion, the tagged DNA fragments are amplified and sequenced, and the regions that accumulate the most insertions are interpreted as the most accessible. The method was introduced by Jason Buenrostro and colleagues in 2013 and has since become one of the most widely used techniques in epigenetics research.
            Beyond simply identifying open regions, the fragments themselves carry structural information about chromatin. Short fragments tend to originate from nucleosome-free regions, while longer fragments appearing at roughly 150 base pair intervals reflect nucleosome spacing  meaning the data can reveal not just where chromatin is accessible, but how it is organized. One additional technical detail worth knowing is the Tn5 offset: because the enzyme inserts adapters at slightly offset positions relative to the actual cut site, many analyses apply a small positional correction to ensure reads are accurately aligned to the true insertion events.
             <a href="#ref-1" class="footnote-ref">[1]</a>.
          </p>
          <blockquote>
            <p><strong>Historical note:</strong> Jason Buenrostro et al. introduced ATAC-seq in 2013, and the method is now widely used in epigenetics research.</p>
          </blockquote>
        </section>

        <section id="paired-end">
          <h2>Single-end vs Paired-end Sequencing</h2>
          <p>
            When it comes to sequencing strategy, paired-end sequencing is strongly preferred over single-end for ATAC-seq. Since each ATAC fragment has two ends corresponding to two separate Tn5 insertion sites, paired-end reads allow you to reconstruct the full length of every fragment and pinpoint exactly where Tn5 inserted on both sides. This information is essential for fragment-length analysis, nucleosome positioning, and accurately locating insertion sites. Single-end sequencing discards half of this information and noticeably reduces the sensitivity of downstream analyses. For most standard experiments, sequencing to a depth of around 10 million read pairs per sample is sufficient for routine differential accessibility and motif analyses, though deeper sequencing may be warranted for more specialized applications.
          </p>
        </section>

        <section id="pipeline-overview">
          <h2>High-level Pipeline Overview</h2>
          <p>ATAC-seq analysis can be thought of in three major stages. Each stage breaks down into concrete steps with the usual tools given as examples.</p>

          <h3 id="stage-a">Stage A — Data Processing (raw → cleaned alignments)</h3>
          <ul>
            <li><strong>Quality control of raw reads</strong> (FastQC): check per-base quality, adapter content, overrepresented sequences.</li>
            <li><strong>Adapter trimming</strong> (Trim Galore / Cutadapt): remove sequencing adapters, especially important if many short fragments exist.</li>
            <li><strong>Alignment</strong> to the reference genome (Bowtie2 / BWA): map reads to genome; use parameters that preserve paired-end information and allow fragment length filtering.</li>
            <li><strong>Filtering</strong> (SAMtools / Picard): remove mitochondrial reads (often abundant in ATAC), low-quality mappings, and PCR duplicates.</li>
            <li><strong>Tn5 offset adjustment</strong>: shift alignments by +4/−5 bp (strand-specific) to center reads on cut sites for insertion calling.</li>
          </ul>

          <h3 id="stage-b">Stage B — Peak Calling & Peak Set Construction</h3>
          <ul>
            <li><strong>Peak calling per sample</strong> (MACS2 or pipeline defaults): find genomic regions with enriched insertions.</li>
            <li><strong>Merge peaks across samples</strong> to create a union peak set (so all samples are compared on the same feature set).</li>
            <li><strong>Count insertions</strong> (featureCounts / custom scripts): generate a matrix of insertion counts per peak per sample (this becomes your expression-like table for differential tests).</li>
          </ul>

          <h3 id="stage-c">Stage C — Downstream Analysis</h3>
          <ul>
            <li><strong>Differential accessibility</strong> (DESeq2, edgeR, etc.): test which peaks change between conditions.</li>
            <li><strong>Motif enrichment</strong> (HOMER, MEME): identify TF motifs enriched in sets of peaks.</li>
            <li><strong>Peak annotation</strong> (ChIPseeker, HOMER): assign peaks to nearest genes, promoters, enhancers.</li>
            <li><strong>Visualization & integration</strong> (IGV / UCSC Genome Browser, ArchR): inspect tracks, integrate with RNA-seq, ChIP-seq, etc.</li>
          </ul>

          <h3>Recommended Automatic Pipelines</h3>
          <ul>
            <li><strong>PEPATAC:</strong> portable, user-friendly, includes many QC metrics (TSS enrichment, fragment distribution). See <a href="https://pepatac.databio.org/en/latest/">PEPATAC docs</a>.</li>
            <li><strong>ENCODE ATAC-seq pipeline:</strong> consortium-level, thoroughly tested pipeline used by ENCODE <a href="#ref-3" class="footnote-ref">[3]</a>.</li>
            <li><strong>nf-core/atacseq:</strong> community pipeline with standardized inputs and reproducible containers.</li>
          </ul>
        </section>

        <section id="detailed-steps">
          <h2>Step-by-Step Walkthrough</h2>

          <h3 id="step-1">Step 1 — Pre-alignment QC (FastQC)</h3>
          <p><strong>What:</strong> Run FastQC on raw FASTQ files.</p>
          <p><strong>Why:</strong> Find low quality reads, adapter contamination, unusual base composition.</p>
          <p><strong>What to look for:</strong> Per-base quality (Phred), adapter content, overrepresented sequences. If adapters are present, trimming is required.</p>

          <h3 id="step-2">Step 2 — Adapter Trimming (Cutadapt / Trim Galore)</h3>
          <p><strong>What:</strong> Remove adapter sequences and optionally low-quality bases from read ends.</p>
          <p><strong>Why:</strong> Short fragments (common in ATAC) often include adapter sequence; untrimmed adapters cause alignment errors and false positives in peak calling.</p>

          <h3 id="step-3">Step 3 — Alignment (Bowtie2 / BWA)</h3>
          <p><strong>What:</strong> Map paired-end reads to the genome.</p>
          <p><strong>Why:</strong> Correct alignment is needed to localize insertion events; preserve fragment length information produced by paired-end sequencing.</p>
          <p><strong>What to look for:</strong> Mapping rate (ideally >70% for good libraries), fraction of reads mapping to mitochondria (high mitochondrial reads indicate poor nuclei prep). Align using parameters recommended for ATAC (keep properly paired reads, set reasonable max fragment length).</p>

          <h3 id="step-4">Step 4 — Remove Mitochondrial Reads & Duplicates (SAMtools / Picard)</h3>
          <p><strong>What:</strong> Filter out reads aligning to the mitochondrial chromosome (chrM) and mark/remove PCR duplicates.</p>
          <p><strong>Why:</strong> Mitochondrial reads do not report chromatin accessibility and can dominate the library; duplicates can inflate signal if PCR overamplified.</p>
          <p><strong>What to monitor:</strong> Percent mitochondrial reads (low is better); duplication rate (high duplication → low complexity library).</p>

          <h3 id="step-5">Step 5 — Tn5 Offset / Adjust Fragment Centers</h3>
          <p><strong>What:</strong> Shift aligned reads by a small number of bases (strand-specific) so they represent the precise cut site of Tn5.</p>
          <p><strong>Why:</strong> Centers insertion events correctly for accurate peak calling and footprinting analyses.</p>

          <h3 id="step-6">Step 6 — Peak Calling (MACS2 or pipeline default)</h3>
          <p><strong>What:</strong> Detect genomic regions with enriched insertions compared with background.</p>
          <p><strong>Why:</strong> Peaks approximate open chromatin regions used for downstream interpretation.</p>

          <h3 id="step-7">Step 7 — Merge Peaks & Count Insertions</h3>
          <p><strong>What:</strong> Build a union (consensus) peak set across all samples and count insertions per sample per peak (count matrix).</p>
          <p><strong>Why:</strong> Ensures all samples are compared on the same feature list for differential testing.</p>

          <h3 id="step-8">Step 8 — Downstream Analyses</h3>
          <p>This includes:</p>
          <ul>
            <li>Differential accessibility tests (DESeq2/edgeR)</li>
            <li>Motif enrichment and TF inference</li>
            <li>Peak annotation and integration with expression data</li>
            <li>Visualization in genome browsers</li>
          </ul>
        </section>

        <section id="qc-metrics">
          <h2>Key QC Metrics</h2>
          <p>These are the quality control metrics you should always check:</p>
          <ul>
            <li><strong>Sequencing depth:</strong> number of read pairs (aim ≈10M read pairs for routine experiments).</li>
            <li><strong>Mapping rate:</strong> fraction of reads that align to the genome.</li>
            <li><strong>Fraction mitochondrial reads:</strong> high % suggests bad nuclei prep; mitochondrial reads are typically removed.</li>
            <li><strong>TSS enrichment score:</strong> high enrichment at transcription start sites indicates good signal-to-noise (pipelines like PEPATAC report this).</li>
            <li><strong>Fragment length distribution:</strong> peaks at nucleosome-free (~&lt;100 bp) and mono/di/tri-nucleosome multiples (~150 bp) indicate expected biology.</li>
            <li><strong>Duplicate rate / library complexity:</strong> high duplication reduces usable unique reads.</li>
          </ul>
        </section>

        <section id="common-problems">
          <h2>Common Problems & Practical Tips</h2>
          <ul>
            <li><strong>Too many mitochondrial reads:</strong> optimize nuclei isolation (gentler lysis) and remove mtDNA reads after alignment.</li>
            <li><strong>Low TSS enrichment:</strong> indicates low signal; check sample prep quality and sequencing depth.</li>
            <li><strong>Adapter contamination:</strong> always trim adapters, especially if fragments are short.</li>
            <li><strong>Very low mapping rate:</strong> check reference genome, read format, and whether data are single-end vs paired-end mismatch.</li>
            <li><strong>High duplication:</strong> use more input material, reduce PCR cycles if possible, or accept lower complexity for QC experiments.</li>
          </ul>
        </section>

        <section id="recommended-tools">
          <h2>Tools & Pipeline Recommendations</h2>
          <h3>Quick Commands / Small Toolset</h3>
          <ul>
            <li><strong>FastQC</strong> — raw read QC</li>
            <li><strong>seqtk</strong> — subsampling & basic FASTQ ops</li>
            <li><strong>Cutadapt / Trim Galore</strong> — trimming</li>
            <li><strong>Bowtie2</strong> — aligner commonly used for ATAC</li>
            <li><strong>SAMtools / Picard</strong> — filtering & marking duplicates</li>
            <li><strong>MACS2</strong> — peak calling</li>
          </ul>

          <h3>Full Pipelines (recommended for beginners)</h3>
          <ul>
            <li><a href="https://pepatac.databio.org/en/latest/">PEPATAC</a> — portable, produces many QC metrics including TSS enrichment.</li>
            <li><a href="https://www.encodeproject.org/">ENCODE ATAC-seq pipeline</a> — consortium best practices.</li>
            <li><a href="https://nf-co.re/usage/atacseq">nf-core/atacseq</a> — community pipeline with standardization and container support.</li>
          </ul>
        </section>

        <section id="workflow-checklist">
          <h2>Practical Checklist</h2>
          <ol>
            <li>Confirm paired-end sequencing and target depth (e.g., 10M read pairs).</li>
            <li>Run FastQC on raw FASTQ and inspect adapter content & per-base quality.</li>
            <li>Trim adapters if needed (Cutadapt / Trim Galore).</li>
            <li>Align reads to the correct reference genome (paired-end aware).</li>
            <li>Filter out mitochondrial reads and low-quality mappings; mark/remove duplicates.</li>
            <li>Apply Tn5 offset correction to represent cut sites.</li>
            <li>Call peaks (MACS2 or pipeline default).</li>
            <li>Merge peaks across samples and count insertions for differential testing.</li>
            <li>Run downstream analyses (differential, motif enrichment, annotation).</li>
          </ol>
        </section>

        <section id="glossary">
          <h2>Glossary</h2>
          <ul>
            <li><strong>Tn5</strong> — transposase used to insert adapters into open chromatin.</li>
            <li><strong>Fragment</strong> — the DNA segment between paired reads; fragment length carries nucleosome information.</li>
            <li><strong>Peak</strong> — genomic interval with enriched insertions (open chromatin).</li>
            <li><strong>TSS enrichment</strong> — signal enrichment at transcription start sites; a QC metric for ATAC-seq.</li>
            <li><strong>Fragment length distribution</strong> — histogram of fragment sizes; nucleosome periodicity appears as peaks ~150 bp apart.</li>
          </ul>
        </section>

        <section id="references" class="references">
          <h2>References</h2>
          <ol>
            <li id="ref-1">Buenrostro, J.D., Giresi, P.G., Zaba, L.C., Chang, H.Y. and Greenleaf, W.J. (2013). Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position. <em>Nature Methods</em>, 10(12), 1213–1218.</li>
            <li id="ref-2">Yan, F., Powell, D.R., Curtis, D.J. and Wong, N.C. (2020). From reads to insight: a hitchhiker's guide to ATAC-seq data analysis. <em>Genome Biology</em>, 21, 22.</li>
            <li id="ref-3">The ENCODE Project Consortium (2012). An integrated encyclopedia of DNA elements in the human genome. <em>Nature</em>, 489(7414), 57–74.</li>
          </ol>
        </section>
      </div>
    </div>
  </article>

  <nav class="chapter-nav chapter-nav--next-only">
    <a href="chapter_2.html">
      <span class="nav-direction">Next</span>
      <span class="nav-arrow">&rarr;</span>
    </a>
  </nav>

  <footer class="site-footer">
    <p>&copy; 2026 Bioinformatics by Yerkem Shakhman. Built for wet lab researchers and students in computational biology.</p>
  </footer>

  <script src="blog-post-ui.js"></script>
</body>
</html>
